From 13fb875ec01cd2cacffcaf4c69ff6a0352a54822 Mon Sep 17 00:00:00 2001
From: sonan <sonan@ami.com>
Date: Thu, 4 Jan 2024 22:05:21 +0530
Subject: [PATCH 2/2] Enabled RMCP Ping and reversed the IANA no while
 receiving RMCP Pong

---
 message.hpp         | 1 +
 message_parsers.cpp | 4 ++--
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/message.hpp b/message.hpp
index 1deef71..c62c180 100644
--- a/message.hpp
+++ b/message.hpp
@@ -4,6 +4,7 @@
 #include <memory>
 #include <numeric>
 #include <vector>
+#include "config.h"
 
 namespace message
 {
diff --git a/message_parsers.cpp b/message_parsers.cpp
index 33b53c1..dbb196a 100644
--- a/message_parsers.cpp
+++ b/message_parsers.cpp
@@ -444,14 +444,14 @@ std::vector<uint8_t> flatten(uint8_t asfMsgTag)
 
     // No OEM-specific capabilities exist, therefore the second
     // IANA Enterprise Number contains the same IANA(4542)
-    header->ping.iana = header->iana = endian::to_ipmi(parser::ASF_IANA);
+    header->ping.iana = header->iana = endian::to_network(parser::ASF_IANA);
     header->ping.msgType = static_cast<uint8_t>(RmcpMsgType::PONG);
     header->ping.msgTag = asfMsgTag;
     header->ping.reserved = 0x00;
     header->ping.dataLen =
         parser::RMCP_ASF_PONG_DATA_LEN; // as per spec 13.2.4,
 
-    header->iana = parser::ASF_IANA;
+    header->iana =endian::to_network(parser::ASF_IANA);
     header->oemDefined = 0x00;
     header->suppEntities = parser::ASF_SUPP_ENT;
     header->suppInteract = parser::ASF_SUPP_INT;
-- 
2.43.0


From 8dc96fe0630971432d6dc7fd0dd634607a02d22d Mon Sep 17 00:00:00 2001
From: muthulakshmin <muthulakshmin@ami.com>
Date: Fri, 29 Dec 2023 11:12:12 +0530
Subject: [PATCH 180/180] Added Property Value Incorrect error message while
 post invalid vlanid

Signed-off-by: muthulakshmin <muthulakshmin@ami.com>
---
 redfish-core/lib/ethernet.hpp | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/redfish-core/lib/ethernet.hpp b/redfish-core/lib/ethernet.hpp
index 866218f0..9a5d628e 100644
--- a/redfish-core/lib/ethernet.hpp
+++ b/redfish-core/lib/ethernet.hpp
@@ -2197,6 +2197,7 @@ inline bool
 inline void afterVlanCreate(const std::shared_ptr<bmcweb::AsyncResp>& asyncResp,
                             const std::string& parentInterfaceUri,
                             const std::string& vlanInterface,
+			    const uint32_t vlanId,
                             const boost::system::error_code& ec,
                             const sdbusplus::message_t& m
 
@@ -2225,8 +2226,10 @@ inline void afterVlanCreate(const std::shared_ptr<bmcweb::AsyncResp>& asyncResp,
                 "xyz.openbmc_project.Common.Error.InvalidArgument") ==
             dbusError->name)
         {
-            messages::resourceAlreadyExists(asyncResp->res, "EthernetInterface",
-                                            "Id", vlanInterface);
+            //messages::resourceAlreadyExists(asyncResp->res, "EthernetInterface",
+            //                                "Id", vlanInterface);
+	    messages::propertyValueIncorrect(asyncResp->res,
+                                            "VLANId", vlanId);                                
             return;
         }
         messages::internalError(asyncResp->res);
@@ -2671,9 +2674,9 @@ inline void requestEthernetInterfacesRoutes(App& app)
                                     std::to_string(vlanId);
         crow::connections::systemBus->async_method_call(
             [asyncResp, parentInterfaceUri,
-             vlanInterface](const boost::system::error_code& ec,
+             vlanInterface, vlanId](const boost::system::error_code& ec,
                             const sdbusplus::message_t& m) {
-            afterVlanCreate(asyncResp, parentInterfaceUri, vlanInterface, ec,
+            afterVlanCreate(asyncResp, parentInterfaceUri, vlanInterface, vlanId, ec,
                             m);
         },
             "xyz.openbmc_project.Network", "/xyz/openbmc_project/network",
-- 
2.34.1


From b10fc3a618c5747838f7b0a6f2424897f8d2e0e9 Mon Sep 17 00:00:00 2001
From: gokulp <gokulp@ami.com>
Date: Sat, 2 Sep 2023 02:05:03 +0530
Subject: [PATCH 2438/2438] 
 Recreating_Patch_For_Delete-Subscription-status-code

---
 redfish-core/lib/event_service.hpp | 19 +++++++++++--------
 1 file changed, 11 insertions(+), 8 deletions(-)

diff --git a/redfish-core/lib/event_service.hpp b/redfish-core/lib/event_service.hpp
index 14bddc77..f0434525 100644
--- a/redfish-core/lib/event_service.hpp
+++ b/redfish-core/lib/event_service.hpp
@@ -849,12 +849,22 @@ inline void requestRoutesEventDestination(App& app)
             return;
         }
 
+        if (param.starts_with("snmp"))
+        {
+            deleteSnmpTrapClient(asyncResp, param);
+            EventServiceManager::getInstance().deleteSubscription(param);
+            return;
+        }
+
+        EventServiceManager::getInstance().deleteSubscription(param);
+
         std::shared_ptr<Subscription> subValue =
             EventServiceManager::getInstance().getSubscription(param);
         if (subValue == nullptr)
         {
             // Lookup in Kafka subscription.
             KafkaManager::getInstance().deleteSubscription(param, asyncResp);
+            asyncResp->res.result(boost::beast::http::status::no_content);
             return;
         }
 
@@ -864,14 +874,7 @@ inline void requestRoutesEventDestination(App& app)
             return;
         }
 
-	if (param.starts_with("snmp"))
-	{
-	    deleteSnmpTrapClient(asyncResp, param);
-	    EventServiceManager::getInstance().deleteSubscription(param);
-	    return;
-	}
-
-        EventServiceManager::getInstance().deleteSubscription(param);
+	
         });
 }
 
-- 
2.34.1


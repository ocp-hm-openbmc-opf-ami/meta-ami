From 801aa20ada6a21317c87e7cd87eb14bf11d8b0a5 Mon Sep 17 00:00:00 2001
From: gokulp <gokulp@ami.com>
Date: Mon, 16 Oct 2023 14:53:47 +0530
Subject: [PATCH 41/41] Fixed PostEvent RegistryPrefixe and
 Test-Event-generate-incorrect

---
 redfish-core/lib/event_service.hpp | 17 ++++++-----------
 1 file changed, 6 insertions(+), 11 deletions(-)

diff --git a/redfish-core/lib/event_service.hpp b/redfish-core/lib/event_service.hpp
index b0ff991a..b3282be3 100644
--- a/redfish-core/lib/event_service.hpp
+++ b/redfish-core/lib/event_service.hpp
@@ -37,8 +37,8 @@ namespace redfish
 
 static constexpr const std::array<const char*, 2> supportedEvtFormatTypes = {
     eventFormatType, metricReportFormatType};
-static constexpr const std::array<const char*, 2> supportedRegPrefixes = {
-    "OpenBMC", "TaskEvent"};
+static constexpr const std::array<const char*, 3> supportedRegPrefixes = {
+    "Base", "OpenBMC", "TaskEvent"};
 static constexpr const std::array<const char*, 3> supportedRetryPolicies = {
     "TerminateAfterRetries", "SuspendRetries", "RetryForever"};
 
@@ -61,7 +61,7 @@ inline void getSmtpConfig(const std::shared_ptr<bmcweb::AsyncResp>& aResp)
         if (ec)
         {
             BMCWEB_LOG_ERROR("GetSMTPconfig: Can't get "
-                                "alertMailIface ");
+                             "alertMailIface ");
             messages::internalError(aResp->res);
             return;
         }
@@ -102,8 +102,8 @@ inline void setSmtpConfig(const std::shared_ptr<bmcweb::AsyncResp>& aResp,
          fromAddr](const boost::system::error_code ec) {
         if (ec)
         {
-            BMCWEB_LOG_ERROR( "SetSMTPconfig: Can't get "
-                                "alertMailIface ");
+            BMCWEB_LOG_ERROR("SetSMTPconfig: Can't get "
+                             "alertMailIface ");
             messages::internalError(aResp->res);
             return;
         }
@@ -264,12 +264,7 @@ inline void requestRoutesSubmitTestEvent(App& app)
         {
             return;
         }
-        if (!EventServiceManager::getInstance().sendTestEventLog())
-        {
-            messages::serviceDisabled(asyncResp->res,
-                                      "/redfish/v1/EventService/");
-            return;
-        }
+        EventServiceManager::getInstance().readEventLogsFromFile();
         asyncResp->res.result(boost::beast::http::status::no_content);
     });
 }
-- 
2.34.1


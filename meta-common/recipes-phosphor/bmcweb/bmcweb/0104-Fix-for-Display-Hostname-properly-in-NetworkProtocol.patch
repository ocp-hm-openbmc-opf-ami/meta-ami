From 7d3ed6aa1a366317ce36d310bc0c6a60e90a5ff4 Mon Sep 17 00:00:00 2001
From: prasannas <prasannas@ami.com>
Date: Fri, 1 Sep 2023 16:33:33 +0530
Subject: [PATCH 2424/2424] Fix for Display Hostname properly in
 NetworkProtocol

---
 redfish-core/lib/ethernet.hpp         | 7 +++----
 redfish-core/lib/network_protocol.hpp | 2 +-
 2 files changed, 4 insertions(+), 5 deletions(-)

diff --git a/redfish-core/lib/ethernet.hpp b/redfish-core/lib/ethernet.hpp
index bede4f4..449ba2d 100644
--- a/redfish-core/lib/ethernet.hpp
+++ b/redfish-core/lib/ethernet.hpp
@@ -897,11 +897,10 @@ inline bool isHostnameValid(const std::string& hostname)
         return false;
     }
     // Each label(hostname/subdomains) within a valid FQDN
-    // MUST handle host names of up to 63 characters (RFC 1123)
+    // MUST handle host names of up to 64 characters (RFC 1123)
     // labels cannot start or end with hyphens (RFC 952)
-    // labels can start with numbers (RFC 1123)
-    const std::regex pattern(
-        "^[a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]{0,61}[a-zA-Z0-9]$");
+    // hostname starts with an alphanumeric character
+    const std::regex pattern("^[a-zA-Z0-9]([a-zA-Z0-9\\-]{0,62}[a-zA-Z0-9])?$");
 
     return std::regex_match(hostname, pattern);
 }
diff --git a/redfish-core/lib/network_protocol.hpp b/redfish-core/lib/network_protocol.hpp
index 46dfcee..721983c 100644
--- a/redfish-core/lib/network_protocol.hpp
+++ b/redfish-core/lib/network_protocol.hpp
@@ -456,7 +456,7 @@ inline std::string getHostName()
 {
     std::string hostName;
 
-    std::array<char, HOST_NAME_MAX> hostNameCStr{};
+    std::array<char, HOST_NAME_MAX+1> hostNameCStr{};
     if (gethostname(hostNameCStr.data(), hostNameCStr.size()) == 0)
     {
         hostName = hostNameCStr.data();
-- 
2.9.5


From beaa4e2eea7e337ad37519ac9562fa4560ce5912 Mon Sep 17 00:00:00 2001
From: rkarthika <rkarthika@ami.com>
Date: Thu, 21 Dec 2023 15:41:34 +0530
Subject: [PATCH 170/170] Give range for RememberOldPasswordTimes property

---
 redfish-core/lib/account_service.hpp | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/redfish-core/lib/account_service.hpp b/redfish-core/lib/account_service.hpp
index 9fb54d51..7fa75ca1 100644
--- a/redfish-core/lib/account_service.hpp
+++ b/redfish-core/lib/account_service.hpp
@@ -1796,14 +1796,22 @@ inline void handleAccountServicePatch(
             }
             if (RememberOldPasswordTimes)
             {
+                uint8_t rememberRange = RememberOldPasswordTimes.value();
                 crow::connections::systemBus->async_method_call(
-                    [asyncResp, RememberOldPasswordTimes](
+                    [asyncResp, rememberRange](
                         const boost::system::error_code ec) {
                     if (ec)
                     {
                         messages::internalError(asyncResp->res);
                         return;
                     }
+                    if(rememberRange > 5)
+                    {
+                        std::string RemebrOldPasswdTimes = std::to_string(rememberRange);
+                        std::string_view RembrOldPasswdView(RemebrOldPasswdTimes);
+                        messages::propertyValueOutOfRange(asyncResp->res, RembrOldPasswdView, "RememberOldPasswordTimes");
+                        return;
+                    }
                     messages::success(asyncResp->res);
                 },
                     "xyz.openbmc_project.User.Manager",
-- 
2.34.1


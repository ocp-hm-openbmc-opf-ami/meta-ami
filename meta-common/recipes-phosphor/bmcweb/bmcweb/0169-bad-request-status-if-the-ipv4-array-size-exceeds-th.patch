From e375d64f720975018b7d72892853322799185630 Mon Sep 17 00:00:00 2001
From: Nibin Chacko <nibinc@ami.com>
Date: Thu, 21 Dec 2023 02:49:11 -0500
Subject: [PATCH 169/169] bad request status if the ipv4 array size exceeds the
 limit

---
 redfish-core/lib/ethernet.hpp | 16 +++++++---------
 1 file changed, 7 insertions(+), 9 deletions(-)

diff --git a/redfish-core/lib/ethernet.hpp b/redfish-core/lib/ethernet.hpp
index 866218f0..6c0dc563 100644
--- a/redfish-core/lib/ethernet.hpp
+++ b/redfish-core/lib/ethernet.hpp
@@ -1419,6 +1419,13 @@ inline bool
                                          "IPv4StaticAddresses");
         return false;
     }
+
+    if (input.size() > 1) // checking the array size of ipv4 address
+    {
+        messages::arraySizeTooLong(asyncResp->res, "IPv4StaticAddresses", 1);
+        asyncResp->res.result(boost::beast::http::status::bad_request);
+        return false;
+    }
     unsigned entryIdx = 1;
     for (const nlohmann::json& thisJson : input)
     {
@@ -2415,15 +2422,6 @@ inline void handleEthernetInterfaceInstancePatch(
                             messages::propertyMissing(asyncResp->res, "IPv4StaticAddresses");
                             return;
                         }
-                        else if (ipv4StaticAddresses) // and IPv4StaticAddresses attribute is present
-                        {
-                            nlohmann::json IPv4Static = *ipv4StaticAddresses;
-                            if(IPv4Static.size() > 1)
-                            {
-                                messages::arraySizeTooLong(asyncResp->res,"IPv4StaticAddresses", 1);
-                                return;
-                            }
-                        }
                     }
                     else if(v4Value && ipv4StaticAddresses) // DHCPv4.DHCPEnabled attribute is true and IPv4StaticAddresses attribute is present
                     {
-- 
2.34.1


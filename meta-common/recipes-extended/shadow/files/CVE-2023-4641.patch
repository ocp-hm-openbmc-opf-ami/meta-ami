From a9a83116a62bc431f46fbb7af66ea8d86ee37b87 Mon Sep 17 00:00:00 2001
From: Vasanthakumar K <vasanthakumark@ami.com>
Date: Mon, 18 Mar 2024 19:03:17 +0530
Subject: [PATCH] CVE-2023-4641

CVE: CVE-2023-4641

Reference: https://github.com/shadow-maint/shadow/commit/65c88a43a23c2391dcc90c0abda3e839e9c57904 

Signed-off-by: Vasanthakumar K <vasanthakumark@ami.com>
---
 src/gpasswd.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/src/gpasswd.c b/src/gpasswd.c
index 5983f78..2d8869e 100644
--- a/src/gpasswd.c
+++ b/src/gpasswd.c
@@ -896,6 +896,7 @@ static void change_passwd (struct group *gr)
 		strzero (cp);
 		cp = getpass (_("Re-enter new password: "));
 		if (NULL == cp) {
+			memzero (pass, sizeof pass);
 			exit (1);
 		}
 
-- 
2.34.1

